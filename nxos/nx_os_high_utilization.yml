# ---
# - name: Check network interface high utilization
#   hosts: cisco_router
#   gather_facts: false
#   vars:
#     interface_name: "Ethernet1/60"
#     threshold: 90
#   tasks:
#     - name: Check network utilization of interface on network device
#       nxos_command:
#         commands:
#           - show interface {{ interface_name }}
#         provider:
#           host: "{{ ansible_host }}"
#           username: "{{ ansible_user }}"
#           password: "{{ ansible_password }}"
#           transport: cli
#       register: interface_output

#     - name: Extract interface utilization
#       set_fact:
#         in_bits_per_sec: "{{ interface_output.stdout_lines[5].split()[5] }}"
#         out_bits_per_sec: "{{ interface_output.stdout_lines[5].split()[7] }}"

#     - name: Check if utilization exceeds threshold
#       fail:
#         msg: "Interface {{ interface_name }} high utilization: in_bits_per_sec {{ in_bits_per_sec }}, out_bits_per_sec {{ out_bits_per_sec }}"
#       when: (in_bits_per_sec|int > threshold) or (out_bits_per_sec|int > threshold)
